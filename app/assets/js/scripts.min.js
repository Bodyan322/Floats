
document.addEventListener("DOMContentLoaded", function(event) {


let body = document.body;
let fragment = document.createDocumentFragment();
let mainInput = document.createElement('input');
let buttPrev = document.createElement('button');
let buttNext = document.createElement('button');
let buttParent = document.createElement('button');
let buttChild = document.createElement('button');
let buttSearch= document.createElement('button');
    buttSearch.classList.add('search');
let modalWind = document.createElement('div');
    modalWind.classList.add('renderForm');
let heading = document.createElement('h3');



function main () {
    searchingForm();
    addingStyles();
    searchNode();
    searchNextNode();
    searchPrevNode();
    searchParentNode();
    searchChildNode();
}

main();
function addingStyles(){
    let style = document.createElement('style');
    style.innerHTML = `
    .renderForm {
        position: absolute;
        top: 100px;
        right: 50px;
        border: 2px solid black;
        width: 400px;
        height: 110px;
        background: rgba(255,255,255,0.5);
    }
    .renderForm > button {
        width: 60px;
        height: 25px;
        padding: 0;
        font-size: 15px;
        margin-left: 15px;
        margin-right: 24px;
        margin-top: 5px;
    }
    .renderForm > .search{
        margin: 0;
        width: 80px;
        margin-left: 10px;
        height: 26px;
    }
    .renderForm > h3{
        padding: 15px 0 0 15px;
    }
    .renderForm > input {
        width: 70%;
        margin: 0px 0px 0px 15px;
    }`
    
    
    
    body.appendChild(style);

    
}
function searchingForm (){
    
   

    heading.innerHTML = "Search some node";
    modalWind.appendChild(heading);

    
    modalWind.appendChild(mainInput);


    
    buttSearch.innerHTML = "Search";
    modalWind.appendChild(buttSearch);
    
    
    buttPrev.innerHTML = "Prev";
    buttPrev.disabled = true;
    modalWind.appendChild(buttPrev);


    
    
    buttNext.innerHTML = "Next";
    buttNext.disabled = true;
    modalWind.appendChild(buttNext);


    
    
    buttParent.innerHTML = "Parent";
    buttParent.disabled = true;
    modalWind.appendChild(buttParent);


    
    buttChild.innerHTML = "Children";
    buttChild.disabled = true;
    modalWind.appendChild(buttChild);


    fragment.appendChild(modalWind);
    body.appendChild(fragment);

}

function searchNode () {
        
        buttSearch.addEventListener("click", function () {
        event.preventDefault();

        buttPrev.disabled = false;
        buttParent.disabled = false;
        buttChild.disabled = false;

        let text = mainInput.value;
        mainInput.value = "";
        if (document.querySelector(".bordrred")){
            let elWithClass = document.querySelector(".bordrred");
            elWithClass.removeAttribute("style");
            elWithClass.classList.remove('bordrred');
        }
        if (text) {
            el = document.querySelector(text);
            el.classList.add("bordrred");
            document.querySelector(".bordrred").style.border = "4px solid red";
        }
        makeDisable(el);
       
    });
}


function makeDisable (el) {

    if (el.nextElementSibling) {
        buttNext.disabled = false;
    } else {
        buttNext.disabled = true;
    }
    if (el.previousElementSibling) {
        buttPrev.disabled = false;
    } else {
        buttPrev.disabled = true;
    }
    if (el.parentElement){
        buttParent.disabled = false;
    }  else {
        buttParent.disabled = true;
    }
    if (el.children[0]) {
        buttChild.disabled = false;
    }  else {
        buttChild.disabled = true;
    }
}

function searchNextNode () {
        
    buttNext.addEventListener("click", function () {
        event.preventDefault();

        if(document.querySelector(".bordrred")) {
            if (el.nextElementSibling) {
                let elWithClass = document.querySelector(".bordrred");
                elWithClass.removeAttribute("style");
                elWithClass.classList.remove('bordrred');
            }
        }

        if (el){      
            if (el.nextElementSibling){
            el = el.nextElementSibling;
            el.classList.add("bordrred");
            document.querySelector(".bordrred").style.border = "4px solid red";
            } 
        }
        makeDisable(el);
    });
}

function searchPrevNode () {
        
    buttPrev.addEventListener("click", function () {
        event.preventDefault();

        if(document.querySelector(".bordrred")) {
            if (el.previousElementSibling) {
                let elWithClass = document.querySelector(".bordrred");
                elWithClass.removeAttribute("style");
                elWithClass.classList.remove('bordrred');
            }     
        }
        if (el){
          
            if (el.previousElementSibling){
            el = el.previousElementSibling;
            el.classList.add("bordrred");
            document.querySelector(".bordrred").style.border = "4px solid red";
            }
        }
        makeDisable(el);
    });
}

function searchParentNode () {
        
    buttParent.addEventListener("click", function () {
        event.preventDefault();

        if(document.querySelector(".bordrred")) {
            if (el.parentElement) {
                let elWithClass = document.querySelector(".bordrred");
                elWithClass.removeAttribute("style");
                elWithClass.classList.remove('bordrred');
            }
        }
        if (el){
       
            if (el.parentElement ){
                 el = el.parentElement ;
                 el.classList.add("bordrred");
                 document.querySelector(".bordrred").style.border = "4px solid red";
            } 
        }
        makeDisable(el);
    });
}

function searchChildNode() {
        
    buttChild.addEventListener("click", function () {
        event.preventDefault();

        if(document.querySelector(".bordrred")) {
            if (el.children) {
                let elWithClass = document.querySelector(".bordrred");
                elWithClass.removeAttribute("style");
                elWithClass.classList.remove('bordrred');
            }    
        }
        if (el){

            if (el.children[0]){
                el = el.children[0];
                el.classList.add("bordrred");
                document.querySelector(".bordrred").style.border = "4px solid red";
            }
        }
        makeDisable(el);
    });
}




heading.onmousedown = function(e) {
    
    var coords = getCoords(modalWind);
    var shiftX = e.pageX - coords.left;
    var shiftY = e.pageY - coords.top;
    
    modalWind.style.position = 'absolute';
    moveAt(e);

    body.appendChild(modalWind);

    modalWind.style.zIndex = 1000;


    function moveAt(e) {
        modalWind.style.left = e.pageX - shiftX + 'px';
        modalWind.style.top = e.pageY - shiftY + 'px';
      }

      document.onmousemove = function(e) {
        moveAt(e);
      }

      modalWind.onmouseup = function() {
        document.onmousemove = null;
        modalWind.onmouseup = null;
      }
}

modalWind.ondragstart = function() {
    return false;
  };

  function getCoords(elem) { 
    var box = elem.getBoundingClientRect();
    return {
      top: box.top + pageYOffset,
      left: box.left + pageXOffset
    };
  }





});